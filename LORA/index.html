<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Baseline Scenario View</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h2, h3, h4 { margin-top: 30px; }
    .modality { margin-bottom: 40px; border: 1px solid #aaa; padding: 10px; border-radius: 8px; }
    .archetype { margin: 20px 0; }
    table { border-collapse: collapse; width: 100%; margin-top: 5px; font-size: 0.9em; }
    th, td { border: 1px solid #ccc; padding: 4px 8px; text-align: left; }
    th { background-color: #f0f0f0; }
    .label { font-weight: bold; }
  </style>
</head>
<body>

<h2>Baseline Configuration Viewer</h2>
<input type="file" id="fileInput" accept=".xlsx" />

<div id="output"></div>

<script>
document.getElementById('fileInput').addEventListener('change', handleFile);

function handleFile(event) {
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];
    const json = XLSX.utils.sheet_to_json(sheet);

    const baseline = json.slice(1, 21); // rows 2â€“21 (1-indexed)
    const grouped = {};

    for (const row of baseline) {
      const modality = row['Modality'] || 'UNKNOWN';
      const archetype = row['Archetype'] || 'UNKNOWN';
      if (!grouped[modality]) grouped[modality] = {};
      grouped[modality][archetype] = row;
    }

    render(grouped);
  };
  reader.readAsArrayBuffer(event.target.files[0]);
}

function render(data) {
  const container = document.getElementById('output');
  container.innerHTML = '';

  for (const [modality, archetypes] of Object.entries(data)) {
    const modDiv = document.createElement('div');
    modDiv.className = 'modality';
    modDiv.innerHTML = `<h3>Modality: ${modality}</h3>`;

    for (const [arch, row] of Object.entries(archetypes)) {
      const archDiv = document.createElement('div');
      archDiv.className = 'archetype';
      archDiv.innerHTML = `<h4>Archetype: ${arch}</h4>`;
      const table = document.createElement('table');

      const headers = Object.keys(row);
      const body = headers.map(key => `
        <tr><th>${key}</th><td>${row[key]}</td></tr>
      `).join('');
      table.innerHTML = `<tbody>${body}</tbody>`;
      archDiv.appendChild(table);
      modDiv.appendChild(archDiv);
    }

    container.appendChild(modDiv);
  }
}
</script>

</body>
</html>